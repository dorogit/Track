{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport createDataContext from \"./createDataContext\";\nimport tracker from \"../api/tracker\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar trackReducer = function trackReducer(action, state) {\n  switch (action.type) {\n    case \"SIGN_UP\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        token: action.payload\n      });\n    case \"SIGN_IN\":\n      console.log(action.payload);\n    default:\n      return state;\n  }\n};\nvar signUp = function signUp(dispatch) {\n  return function () {\n    var _ref2 = _asyncToGenerator(function* (_ref) {\n      var email = _ref.email,\n        password = _ref.password;\n      try {\n        var response = yield tracker.post('/signup', {\n          email: email,\n          password: password\n        });\n        yield AsyncStorage.setItem('token', response.data.token);\n        var token = yield AsyncStorage.getItem('token');\n        console.log(\"token received and set\", token);\n        dispatch({\n          type: \"SIGN_UP\",\n          payload: response.data.token\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    });\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nvar signIn = function signIn(dispatch) {\n  return function () {\n    var _ref4 = _asyncToGenerator(function* (_ref3) {\n      var email = _ref3.email,\n        password = _ref3.password;\n      var token = yield AsyncStorage.getItem('token');\n      console.log(token);\n      try {\n        var response = yield tracker.post('/signin', {\n          headers: {\n            authorization: \"bearer \" + token\n          },\n          body: {\n            \"email\": email,\n            \"password\": password\n          }\n        });\n        dispatch({\n          type: \"SIGN_UP\",\n          payload: response.data.token\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    });\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\nvar signOut = function signOut() {};\nvar _createDataContext = createDataContext(trackReducer, {\n    signUp: signUp,\n    signIn: signIn\n  }, {\n    token: null,\n    isSignedIn: false\n  }),\n  Context = _createDataContext.Context,\n  Provider = _createDataContext.Provider;\nexport { Context, Provider };","map":{"version":3,"names":["createDataContext","tracker","AsyncStorage","trackReducer","action","state","type","_objectSpread","token","payload","console","log","signUp","dispatch","_ref2","_asyncToGenerator","_ref","email","password","response","post","setItem","data","getItem","error","_x","apply","arguments","signIn","_ref4","_ref3","headers","authorization","body","_x2","signOut","_createDataContext","isSignedIn","Context","Provider"],"sources":["D:/Programming/native/Track/Track-app/src/context/TrackContext.js"],"sourcesContent":["import createDataContext from \"./createDataContext\";\nimport tracker from \"../api/tracker\";\nimport AsyncStorage from '@react-native-async-storage/async-storage'\n\nconst trackReducer = (action, state) => {\n  switch (action.type) {\n    case \"SIGN_UP\":\n      return {...state, token:action.payload}\n    case \"SIGN_IN\":\n      console.log(action.payload)\n    default:\n      return state\n  }\n}\n\nconst signUp = (dispatch) => {\n  return async ( {email, password} ) => {\n    try {\n      const response = await tracker.post('/signup', {email:email,password:password})\n      await AsyncStorage.setItem('token', response.data.token)\n      const token = await AsyncStorage.getItem('token')\n      console.log(\"token received and set\", token)\n      dispatch({ type: \"SIGN_UP\", payload: response.data.token })\n    } catch (error) {\n      console.log(error)\n    }\n  }\n}\n\nconst signIn = (dispatch) => {\n  return async ( {email, password} ) => {\n    const token = await AsyncStorage.getItem('token')\n    console.log(token)\n    try {\n      const response = await tracker.post('/signin', {\n        headers:{\n          authorization:`bearer ${token}`\n        },\n      body:{\n        \"email\":email,\n        \"password\":password\n      }\n      })\n      dispatch({ type: \"SIGN_UP\", payload: response.data.token })\n    } catch (error) {\n      console.log(error)\n    }\n  }\n}\n\nconst signOut = () =>{\n  // get a {email, password}\n  //handle success by updating state to IF user is signed in\n}\n\nexport const {Context, Provider} = createDataContext(\n  trackReducer,\n  { signUp,signIn },\n  {token:null, isSignedIn: false}\n)"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}